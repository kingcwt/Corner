<!DOCTYPE html><html lang="zh"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.ico"><link rel="apple-touch-icon" href="/pwa_512.png" sizes="192x192"><meta name="generator" content="Astro v4.5.5"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1f1f1f"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"><meta name="color-scheme" content="light dark"><!-- Canonical URL --><link rel="canonical" href="https://astro-blog-ecru-phi.vercel.app/posts/ad6cb205/"><link rel="sitemap" href="/sitemap-index.xml"><!-- Primary Meta Tags --><title>Core React</title><meta name="title" content="Core React"><meta name="description" content="React interview Questions &#38; Answers  🔥 🔥 🔥"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://astro-blog-ecru-phi.vercel.app/posts/ad6cb205/"><meta property="og:title" content="Core React"><meta property="og:description" content="React interview Questions &#38; Answers  🔥 🔥 🔥"><meta property="og:image" content="https://astro-blog-ecru-phi.vercel.app/_astro/cover1.D9zrw50Z.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://astro-blog-ecru-phi.vercel.app/posts/ad6cb205/"><meta property="twitter:title" content="Core React"><meta property="twitter:description" content="React interview Questions &#38; Answers  🔥 🔥 🔥"><meta property="twitter:image" content="https://astro-blog-ecru-phi.vercel.app/_astro/cover1.D9zrw50Z.png"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100..900&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="manifest" href="/manifest.webmanifest"><style>@media screen and (min-width: 768px){header nav ul{justify-content:flex-start!important;gap:2.5rem}header nav ul li:last-child{position:absolute;right:2rem}}
</style>
<link rel="stylesheet" href="/_astro/_slug_.DNWGn5mT.css" />
<style>#themeToggle[data-astro-cid-otufduau]{border:0;background:none}path[data-astro-cid-otufduau]{transition:fill .2s ease-in-out}.sun[data-astro-cid-otufduau]{fill:transparent}.moon[data-astro-cid-otufduau]{fill:#000}.dark .sun[data-astro-cid-otufduau]{fill:#fff}.dark .moon[data-astro-cid-otufduau]{fill:transparent}
</style>
<link rel="stylesheet" href="/_astro/_page_.YzIr0Yvd.css" /><script type="module" src="/_astro/hoisted.BVda4YDk.js"></script>
<script type="module" src="/_astro/page.BOzSQxG5.js"></script></head><body class="bg-primary-light text-primary-dark dark:bg-primary-dark dark:text-white">  <header class="sticky top-0 z-10 flex h-[100px] items-center justify-end backdrop-blur-sm dark:bg-primary-dark dark:bg-opacity-95 min-[1500px]:h-[120px]"> <nav> <ul class="relative flex h-full w-full items-center justify-between rounded-full bg-white p-5 text-primary shadow-md dark:bg-[#0000004d]"> <li> <a href="/">🌐首页</a> </li><li> <a href="/tags">🔖标签</a> </li><li> <a href="/archive">🗂️归档</a> </li><li> <a href="/search">🔍搜索</a> </li> <li class="flex items-center"><button id="themeToggle" aria-label="themeToggle" data-astro-cid-otufduau> <svg width="20px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" data-astro-cid-otufduau> <path class="sun" fill-rule="evenodd" d="M12 17.5a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zm0 1.5a7 7 0 1 0 0-14 7 7 0 0 0 0 14zm12-7a.8.8 0 0 1-.8.8h-2.4a.8.8 0 0 1 0-1.6h2.4a.8.8 0 0 1 .8.8zM4 12a.8.8 0 0 1-.8.8H.8a.8.8 0 0 1 0-1.6h2.5a.8.8 0 0 1 .8.8zm16.5-8.5a.8.8 0 0 1 0 1l-1.8 1.8a.8.8 0 0 1-1-1l1.7-1.8a.8.8 0 0 1 1 0zM6.3 17.7a.8.8 0 0 1 0 1l-1.7 1.8a.8.8 0 1 1-1-1l1.7-1.8a.8.8 0 0 1 1 0zM12 0a.8.8 0 0 1 .8.8v2.5a.8.8 0 0 1-1.6 0V.8A.8.8 0 0 1 12 0zm0 20a.8.8 0 0 1 .8.8v2.4a.8.8 0 0 1-1.6 0v-2.4a.8.8 0 0 1 .8-.8zM3.5 3.5a.8.8 0 0 1 1 0l1.8 1.8a.8.8 0 1 1-1 1L3.5 4.6a.8.8 0 0 1 0-1zm14.2 14.2a.8.8 0 0 1 1 0l1.8 1.7a.8.8 0 0 1-1 1l-1.8-1.7a.8.8 0 0 1 0-1z" data-astro-cid-otufduau></path> <path class="moon" fill-rule="evenodd" d="M16.5 6A10.5 10.5 0 0 1 4.7 16.4 8.5 8.5 0 1 0 16.4 4.7l.1 1.3zm-1.7-2a9 9 0 0 1 .2 2 9 9 0 0 1-11 8.8 9.4 9.4 0 0 1-.8-.3c-.4 0-.8.3-.7.7a10 10 0 0 0 .3.8 10 10 0 0 0 9.2 6 10 10 0 0 0 4-19.2 9.7 9.7 0 0 0-.9-.3c-.3-.1-.7.3-.6.7a9 9 0 0 1 .3.8z" data-astro-cid-otufduau></path> </svg> </button> <script>
  if (!localStorage.theme) {
    const isDark = window.matchMedia('(prefers-color-scheme: dark)').matches
    localStorage.setItem('theme', isDark ? 'dark' : 'light')
  }
  localStorage.theme === 'dark' ? document.documentElement.classList.add('dark') : ''
</script>   </li> </ul> </nav>  </header>  <main class="flex flex-col justify-between"> <div data-pagefind-body class="rounded-lg border p-5 dark:border-primary-gray max-[500px]:p-2"> <article> <h2 data-pagefind-ignore class="mt-2">Core React</h2>  <div data-pagefind-ignore class="my-2 text-right text-xs text-gray-400"> <a class="mx-1 inline-block text-xs no-underline" href="/tags/React">
#React </a> 2024/07/25 21:21:06 </div> <img src="/_astro/cover1.D9zrw50Z_1Tvseu.webp" loading="eager" data-pagefind-meta="image[src]" class="mb-4" alt="" width="774" height="580" decoding="async"> <details><summary>Table of Contents</summary><ol class="toc toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#1-什么是react">1. 什么是React?</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#2-react进化的历史是怎样的">2. React进化的历史是怎样的？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#3-react-的主要特性是什么">3. React 的主要特性是什么？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#4-什么是-jsx">4. 什么是 JSX？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#5-元素-element-和-组件-component-有什么区别">5. 元素 (Element) 和 组件 (Component) 有什么区别？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#6-如何在-react-中创建组件">6. 如何在 React 中创建组件？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#7-何时使用类组件而不是函数组件">7. 何时使用类组件而不是函数组件？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#8-什么是纯组件">8. 什么是纯组件？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#9-react-中的状态是什么">9. React 中的状态是什么?</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#10-react-中的-props-是什么">10. React 中的 props 是什么?</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#11-state-和-props-有什么区别">11. state 和 props 有什么区别?</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#12-react-中的合成事件是什么">12. React 中的合成事件是什么?</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#13-什么是内联条件表达式">13. 什么是内联条件表达式？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#14-什么是keyprop以及在元素数组中使用它有什么好处">14. 什么是“key”prop，以及在元素数组中使用它有什么好处？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#15-什么是虚拟-dom">15. 什么是虚拟 DOM？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#16-虚拟dom的工作原理及其相关细节">16. 虚拟DOM的工作原理及其相关细节:</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#17-react-fiber">17. React Fiber</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#18-react-中的-lifting-state-up-是什么">18. React 中的 Lifting State Up 是什么？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#19-children-属性是什么">19. children 属性是什么？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#20-react中的reconciliation是什么">20. React中的Reconciliation是什么？</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#具体比较策略">具体比较策略</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#优化-reconciliation-过程-react-17">优化 Reconciliation 过程 (React 17+):</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h4"><a class="toc-link toc-link-h4" href="#1-usetransition">1. useTransition</a></li><li class="toc-item toc-item-h4"><a class="toc-link toc-link-h4" href="#2-usedeferredvalue">2. useDeferredValue</a></li><li class="toc-item toc-item-h4"><a class="toc-link toc-link-h4" href="#3-useid">3. useId</a></li><li class="toc-item toc-item-h4"><a class="toc-link toc-link-h4" href="#4-suspense-和-lazy">4. Suspense 和 lazy</a></li></ol></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#21-react-中的合成事件是什么">21. React 中的合成事件是什么?</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h4"><a class="toc-link toc-link-h4" href="#处理表单输入">处理表单输入</a></li><li class="toc-item toc-item-h4"><a class="toc-link toc-link-h4" href="#使用eventpersist进行异步处理">使用event.persist()进行异步处理</a></li><li class="toc-item toc-item-h4"><a class="toc-link toc-link-h4" href="#处理键盘事件">处理键盘事件</a></li><li class="toc-item toc-item-h4"><a class="toc-link toc-link-h4" href="#阻止事件冒泡">阻止事件冒泡</a></li><li class="toc-item toc-item-h4"><a class="toc-link toc-link-h4" href="#访问原生事件">访问原生事件</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#22-什么是-reactdomserver">22. 什么是 ReactDOMServer</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#23-有哪些流行的react特定的linters">23. 有哪些流行的react特定的linters</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#24-什么是-react-router">24. 什么是 React Router？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#25-react-router与history库有何不同">25. React Router与History库有何不同？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#26-react为什么使用classname属性而不是class属性作为类名">26. React为什么使用className属性而不是class属性作为类名？</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#27-什么是react-createportal">27. 什么是React createPortal?</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#28-如何在react中使用innerhtml">28. 如何在React中使用innerHTML?</a></li></ol></details><h2 id="1-什么是react">1. 什么是React?</h2><a href="#1-什么是react"><span class="icon icon-link"></span></a>
<p>React（又名 React.js 或 ReactJS）是一个开源前端 JavaScript 库，用于构建可组合的用户界面，尤其是单页应用程序。它用于以声明式方法处理基于组件的 Web 和移动应用程序的视图层。</p>
<h2 id="2-react进化的历史是怎样的">2. React进化的历史是怎样的？</h2><a href="#2-react进化的历史是怎样的"><span class="icon icon-link"></span></a>
<p>React由Facebook的软件工程师<a href="https://github.com/jordwalke" target="_blank">Jordan Walke</a>建立，他发布了一个名为“FaxJS”的React早期原型。 他受到XHP（一个PHP的HTML组件库）的影响。于2011年首次部署在Facebook的News Feed上，随后于2012年部署在Instagram上。 于2013年5月在JSConf US宣布开放源代码。</p>
<p>React Native 于2015年2月在Facebook的React Conf上宣布，并于2015年3月开放源代码，支持使用React进行原生Android、iOS和UWP开发。</p>
<p>2017年4月18日，Facebook发布了React Fiber，这是一套新的内部渲染算法，与React的旧渲染算法Stack不同。React Fiber将成为React工具库未来任何改进和功能开发的基础。[已过时] 使用React程序撰写的实际语法不会改变；只有语法的执行方式发生了变化。 React的旧渲染系统Stack是在不了解系统对动态变化的关注点的时候开发的。Stack绘制复杂动画的速度很缓慢，例如，试图在一个块中完成所有动画。Fiber将动画分解为可以分布在多个帧上的片段。同样，一个页面的结构可以分解为可以单独维护和更新的片段。JavaScript函数和虚拟DOM对像被称为“fibers”，每个都可以单独操作和更新，从而实现更流畅的屏幕渲染。</p>
<p>2017年9月26日，React 16.0向公众发布。</p>
<p>2019年2月16日，React 16.8向公众发布。 该版本导入了React Hooks。</p>
<p>2020年8月10日，React团队宣布了React v17.0的第一个候选版本，值得关注的是第一个主要版本没有对面向React开发人员的API进行重大更改</p>
<h2 id="3-react-的主要特性是什么">3. React 的主要特性是什么？</h2><a href="#3-react-的主要特性是什么"><span class="icon icon-link"></span></a>
<p>React 的主要特性包括：</p>
<ul>
<li>使用JSX语法，这是 JS 的语法扩展，允许开发人员在 JS 代码中编写 HTML。</li>
<li>考虑到真实 DOM 操作成本高昂，它使用虚拟 DOM而不是真实 DOM。</li>
<li>支持服务器端渲染，这对搜索引擎优化（SEO）很有用。</li>
<li>遵循单向或单向数据流或数据绑定。</li>
<li>使用可重复使用/可组合的UI 组件来开发视图。</li>
</ul>
<h2 id="4-什么是-jsx">4. 什么是 JSX？</h2><a href="#4-什么是-jsx"><span class="icon icon-link"></span></a>
<p>JSX代表JavaScript XML，它是 ECMAScript 的类似 XML 的语法扩展。基本上，它只是为函数提供了语法糖<code>React.createElement(type,props,...children)</code>，为我们提供了 JavaScript 的表达能力以及类似 HTML 的模板语法。</p>
<p>在下面的例子中，<code>&#x3C;h1></code>标签内的文本作为 JavaScript 函数返回给渲染函数。</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>greeting<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token string">"Hello, this is a JSX Code!"</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span></code></pre>
<p>如果你不使用 JSX 语法，则相应的 JavaScript 代码应按如下方式编写</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createElement <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword control-flow">return</span> <span class="token function">createElement</span><span class="token punctuation">(</span>
</span><span class="code-line line-number" line="5">    <span class="token string">"h1"</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="6">    <span class="token punctuation">{</span> <span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token string">"greeting"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="7">    <span class="token string">"Hello, this is a JSX Code!"</span>
</span><span class="code-line line-number" line="8">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="9"><span class="token punctuation">}</span>
</span></code></pre>
<h2 id="5-元素-element-和-组件-component-有什么区别">5. 元素 (Element) 和 组件 (Component) 有什么区别？</h2><a href="#5-元素-element-和-组件-component-有什么区别"><span class="icon icon-link"></span></a>
<p>元素是一个简单的对象，它以 DOM 节点或其他组件的形式描述您想要在屏幕上显示的内容。元素可以在其 props 中包含其他元素。创建 React 元素的成本很低。元素一旦创建，就无法改变。</p>
<p>React Element 的 JavaScript 表示（没有 JSX）如下：</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">"login-btn"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"Login"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<p>这个元素可以使用 JSX 简化</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>login-btn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">Login</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
</span></code></pre>
<p>上述<code>React.createElement()</code>函数返回一个如下对象：</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'div'</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="3">  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token string">'Login'</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="5">    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'login-btn'</span>
</span><span class="code-line line-number" line="6">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="7"><span class="token punctuation">}</span>
</span></code></pre>
<p>最后，该元素使用 呈现到 DOM<code>ReactDOM.render()</code></p>
<p>而组件可以用几种不同的方式声明。它可以是具有render()方法的类，也可以定义为函数。无论哪种情况，它都以 props 作为输入，并返回 JSX 树作为输出：</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> <span class="token function-variable function"><span class="token maybe-class-name">Button</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> handleLogin <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="2">  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token string">"login-btn"</span><span class="token punctuation">}</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleLogin<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="3"><span class="token plain-text">    Login
</span></span><span class="code-line line-number" line="4"><span class="token plain-text">  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="5"><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<p>然后 JSX 被转换成React.createElement()函数树：</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> <span class="token function-variable function"><span class="token maybe-class-name">Button</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> handleLogin <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=></span>
</span><span class="code-line line-number" line="2">  <span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span>
</span><span class="code-line line-number" line="3">    <span class="token string">"div"</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="4">    <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">"login-btn"</span><span class="token punctuation">,</span> <span class="token literal-property property">onClick</span><span class="token operator">:</span> handleLogin <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="5">    <span class="token string">"Login"</span>
</span><span class="code-line line-number" line="6">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<h2 id="6-如何在-react-中创建组件">6. 如何在 React 中创建组件？</h2><a href="#6-如何在-react-中创建组件"><span class="icon icon-link"></span></a>
<p>组件是 React 中创建用户界面 (UI) 的构建块。有两种创建组件的方法。</p>
<p>1 函数组件：这是创建组件最简单的方法。这些是纯 JavaScript 函数，它们接受 props 对象作为唯一参数，并返回 React 元素以呈现输出：</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Greeting</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> message <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span></code></pre>
<p>2 类组件：你也可以使用 ES6 类来定义组件。上面的函数组件可以写成类组件：</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">class</span> <span class="token class-name">Greeting</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">    <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">props</span><span class="token punctuation">.</span><span class="token property-access">message</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="5"><span class="token punctuation">}</span>
</span></code></pre>
<h2 id="7-何时使用类组件而不是函数组件">7. 何时使用类组件而不是函数组件？</h2><a href="#7-何时使用类组件而不是函数组件"><span class="icon icon-link"></span></a>
<p>在添加 Hooks（即 React 16.8 及以上版本）后，始终建议在 React 中使用函数组件而不是类组件。因为您也可以在函数组件中使用仅在类组件中可用的状态、生命周期方法和其他功能。</p>
<ul>
<li>
<p>使用类组件
1 如果您需要某个 React 功能，但其函数组件等效项尚未出现，例如错误边界。
2 在需要向后兼容或与旧代码集成的场景中</p>
</li>
<li>
<p>使用函数组件：
1 如果您不需要状态或生命周期方法，并且您的组件纯粹是展示性的。
2 为了简单性、可读性和现代代码实践，特别是使用 React Hooks 来实现状态和副作用。</p>
</li>
</ul>
<blockquote>
<p>建议使用函数组件而不是类组件</p>
</blockquote>
<p>上述库中的错误边界的使用非常简单。</p>
<blockquote>
<p>使用 react-error-boundary 时请注意： ErrorBoundary 是一个客户端组件。您只能向其传递可序列化的 props，或在具有指令的文件中使用它”use client”;。</p>
</blockquote>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token string">"use client"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">ErrorBoundary</span> <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react-error-boundary"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">ErrorBoundary</span></span> <span class="token attr-name">fallback</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">Something went wrong</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="6"><span class="token plain-text">  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">ExampleApplication</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="7"><span class="token plain-text"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span><span class="token class-name">ErrorBoundary</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span></code></pre>
<h2 id="8-什么是纯组件">8. 什么是纯组件？</h2><a href="#8-什么是纯组件"><span class="icon icon-link"></span></a>
<p>纯组件是指对相同状态和 props 渲染相同输出的组件。在函数组件中，您可以通过<code>React.memo()</code>围绕组件的记忆化API来实现这些纯组件。此API通过使用浅比较来比较先前的props和新的 props，从而防止不必要的重新渲染。因此，它将有助于性能优化。
但同时，它不会将之前的状态与当前状态进行比较，因为函数组件本身默认在你再次设置相同状态时防止不必要的渲染。
记忆组件的语法表示如下所示，</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> <span class="token maybe-class-name">MemoizedComponent</span> <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token maybe-class-name">SomeComponent</span><span class="token punctuation">,</span> arePropsEqual<span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<p>下面是子组件（即 EmployeeProfile）如何防止父组件（即 EmployeeRegForm）传递的相同props重新渲染的示例。</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> memo<span class="token punctuation">,</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword">const</span> <span class="token maybe-class-name">EmployeeProfile</span> <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">EmployeeProfile</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name<span class="token punctuation">,</span> email <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="5">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="6"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">Name:</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="7"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">Email: </span><span class="token punctuation">{</span>email<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="8"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span></span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="9">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="10"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="11"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">EmployeeRegForm</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="12">  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="13">  <span class="token keyword">const</span> <span class="token punctuation">[</span>email<span class="token punctuation">,</span> setEmail<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="14">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="15">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="16"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>label</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="17"><span class="token plain-text">        Name: </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setName</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="18"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>label</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="19"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>label</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="20"><span class="token plain-text">        Email:</span><span class="token punctuation">{</span><span class="token string">" "</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="21"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>email<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setEmail</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="22"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>label</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="23"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>hr</span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="24"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">EmployeeProfile</span></span> <span class="token attr-name">name</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="25"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span></span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="26">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="27"><span class="token punctuation">}</span>
</span></code></pre>
<p>在上面的代码中，email属性尚未传递给子组件。因此，email属性更改不会引发任何重新渲染。</p>
<p>注意： React.memo()是高阶组件。</p>
<h2 id="9-react-中的状态是什么">9. React 中的状态是什么?</h2><a href="#9-react-中的状态是什么"><span class="icon icon-link"></span></a>
<p>组件的状态是一个对象，其中包含一些可能在组件生命周期内发生变化的信息。重点是，只要状态对象发生变化，组件就会重新渲染。始终建议使我们的状态尽可能简单，并尽量减少有状态组件的数量。</p>
<img src="../../../public//state.jpg">
<p>让我们以具有状态的User组件为例message。这里，useState钩子已用于向 User 组件添加状态，并返回包含当前状态和更新它的函数的数组。</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">User</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">"Welcome to React world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="7">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="8"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>message<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="9"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="10">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="11"><span class="token punctuation">}</span>
</span></code></pre>
<p>每当 React 调用你的组件或访问useState钩子时，它都会为你提供该特定渲染的状态快照。</p>
<h2 id="10-react-中的-props-是什么">10. React 中的 props 是什么?</h2><a href="#10-react-中的-props-是什么"><span class="icon icon-link"></span></a>
<p>Props是组件的输入。它们是单个值或包含一组值的对象，这些值在创建时传递给组件，类似于 HTML 标签属性。在这里，数据从父组件传递到子组件。</p>
<p>可以使用 ES6（ECMAScript 2015）的析构功能直接访问 props 对象的属性。当未指定 prop 值时，也可以回退到默认值。上面的子组件可以简化如下。</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> <span class="token maybe-class-name">ChildComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> gender <span class="token operator">=</span> <span class="token string">"male"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="3">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="4"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="5"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>age<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="6"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>gender<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="7"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="8">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="9"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre>
<p>注意：<code>null</code>如果传递或值，则不会使用默认值<code>0</code>。即，仅当缺少<code>prop</code>值或<code>undefined</code>已传递值时才使用默认值。</p>
<h2 id="11-state-和-props-有什么区别">11. state 和 props 有什么区别?</h2><a href="#11-state-和-props-有什么区别"><span class="icon icon-link"></span></a>
<p>在 React 中，<code>state</code>和<code>props</code>都是普通的 JavaScript 对象，用于管理组件的数据，但它们的使用方式不同，并且具有不同的特点。</p>
<p>实体state由组件本身管理，可以使用 setter（setState()用于类组件）函数进行更新。与<code>props</code>不同，<code>state</code>可以由组件修改，并用于管理组件的内部状态。此外，状态的更改会触发组件及其子组件的重新渲染。仅使用状态，组件无法实现可重复使用。</p>
<p>另一方面，<code>props</code>（“props”的缩写）由其父组件传递给组件，并且是read-only，这意味着它们不能由自己的组件本身修改。此外，<code>props</code>可用于配置组件的行为并在组件之间传递数据。使用<code>props</code>可以使组件变得可重复使用。</p>
<h2 id="12-react-中的合成事件是什么">12. React 中的合成事件是什么?</h2><a href="#12-react-中的合成事件是什么"><span class="icon icon-link"></span></a>
<p><code>SyntheticEvent</code>是浏览器原生事件的跨浏览器包装器。其API与浏览器原生事件相同，包括<code>stopPropagation()</code>和<code>preventDefault()</code>，但事件在所有浏览器上的运作方式相同。可以使用<code>nativeEvent</code>属性直接从合成事件访问原生事件。</p>
<p>让我们以BookStore标题搜索组件为例，该组件能够获取所有原生事件属性</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">BookStore</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">function</span> <span class="token function">handleTitleChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"The new title is:"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4">    <span class="token comment">// 'e' represents synthetic event</span>
</span><span class="code-line line-number" line="5">    <span class="token keyword">const</span> nativeEvent <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token property-access">nativeEvent</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>nativeEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">    e<span class="token punctuation">.</span><span class="token method function property-access">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8">    e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="9">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="10">
</span><span class="code-line line-number" line="11">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleTitleChange<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="12"><span class="token punctuation">}</span>
</span></code></pre>
<h2 id="13-什么是内联条件表达式">13. 什么是内联条件表达式？</h2><a href="#13-什么是内联条件表达式"><span class="icon icon-link"></span></a>
<p>您可以使用JS提供的if语句或三元表达式来有条件地渲染表达式。除了这些方法之外，您还可以将任何表达式嵌入JSX中，方法是将它们括在花括号中，然后跟上JS逻辑运算符<code>&#x26;&#x26;</code>。</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Hello!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2"><span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">  messages<span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&#x26;&#x26;</span> <span class="token operator">!</span>isLogin <span class="token operator">?</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="4">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">You have </span><span class="token punctuation">{</span>messages<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">}</span><span class="token plain-text"> unread messages.</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="5">  <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="6">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">You don't have unread messages.</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="7">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8"><span class="token punctuation">}</span>
</span></code></pre>
<h2 id="14-什么是keyprop以及在元素数组中使用它有什么好处">14. 什么是“key”prop，以及在元素数组中使用它有什么好处？</h2><a href="#14-什么是keyprop以及在元素数组中使用它有什么好处"><span class="icon icon-link"></span></a>
<p>A是您在通过数组进行映射以呈现数据时应包含的一个特殊属性。Key prop帮助React识别哪些项目已更改、已添加或已删除。
键在其兄弟中应该是唯一的。我们通常使用数据中的 ID 作为键：</p>
<pre class="language-js language-js"><code is:raw="" class="language-js code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> todoItems <span class="token operator">=</span> todos<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">todo</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token operator">&#x3C;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>todo<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>todo<span class="token punctuation">.</span><span class="token property-access">text</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>li<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<p>当你没有渲染项目的稳定 ID 时，你可以使用项目索引作为最后的手段：</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> todoItems <span class="token operator">=</span> todos<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">todo<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>todo<span class="token punctuation">.</span><span class="token property-access">text</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>
<ol>
<li>如果项目的顺序可能会发生变化，则不建议对键使用索引。这可能会对性能产生负面影响，并可能导致组件状态出现问题。</li>
</ol>
</li>
<li>
<ol start="2">
<li>如果您将列表项提取为单独的组件，则在列表组件上应用键而不是li标签</li>
</ol>
</li>
<li>
<ol start="3">
<li><code>key</code>如果列表项中不存在该道具，控制台中会出现一条警告消息</li>
</ol>
</li>
<li>
<ol start="4">
<li>键属性接受字符串或数字，并在内部将其转换为字符串类型</li>
</ol>
</li>
<li>
<ol start="5">
<li>不要像那样动态生成密钥<code>key={Math.random()}</code>。因为密钥永远不会在每次重新渲染和创建的 DOM 之间匹配。[使用uuid库生成唯一的密钥，也不要使用Math.random()]</li>
</ol>
</li>
</ul>
<h2 id="15-什么是虚拟-dom">15. 什么是虚拟 DOM？</h2><a href="#15-什么是虚拟-dom"><span class="icon icon-link"></span></a>
<blockquote>
<p>虚拟DOM( VDOM)是真实DOM的内存表示。UI的表示保存在内存中并与“真实”DOM同步。这是在调用渲染函数和在UI上显示元素之间发生的一个步骤。这个过程称为<code>reconciliation</code></p>
</blockquote>
<ol>
<li>虚拟DOM节点的结构：虚拟DOM节点通常是一个JavaScript对象，包含以下主要属性：</li>
</ol>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token comment">// 或者是函数组件/类组件</span>
</span><span class="code-line line-number" line="3">  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">    <span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token string">'container'</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="5">    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token spread operator">...</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 子节点数组</span>
</span><span class="code-line line-number" line="6">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="7">  <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="8">  <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token keyword null nil">null</span>
</span><span class="code-line line-number" line="9"><span class="token punctuation">}</span>
</span></code></pre>
<ol start="2">
<li>创建虚拟DOM:</li>
</ol>
<ul>
<li>使用JSX</li>
</ul>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">Hello</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>JSX会被Babel等工具转换为React.createElement()调用</li>
</ul>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token string">"container"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"Hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ol start="3">
<li>Diffing算法[React使用启发式算法来高效地比较两棵虚拟DOM树]:</li>
</ol>
<ul>
<li>同级比较：只比较同一层级的节点。</li>
<li>类型不同则直接替换：如果节点类型改变，React会直接卸载旧节点，挂载新节点。</li>
<li>key属性：用于标识同一层级的子元素是否可复用。</li>
</ul>
<ol start="4">
<li>协调过程（Reconciliation）:</li>
</ol>
<ul>
<li>当状态或属性改变时，组件会重新渲染，生成新的虚拟DOM树。</li>
<li>React对比新旧虚拟DOM树，生成一系列最小化的更新操作。</li>
<li>这些操作被收集到一个叫做”更新队列”的结构中。</li>
</ul>
<ol start="5">
<li>批量更新[React会将多个更新操作批量处理，以减少对真实DOM的访问次数]:</li>
<li>渲染阶段和提交阶段:</li>
</ol>
<ul>
<li>渲染阶段：计算变更，可以被中断。</li>
<li>提交阶段：应用这些变更到DOM，这个过程是同步且不可中断的。</li>
</ul>
<ol start="7">
<li>React Fiber的实现:</li>
</ol>
<ul>
<li>Fiber是虚拟DOM的重新实现，它将渲染过程分解成小的工作单元。</li>
<li>每个Fiber节点对应一个组件，包含了组件的状态、props、DOM信息等。</li>
<li>Fiber允许React暂停、恢复和复用渲染工作。</li>
</ul>
<ol start="8">
<li>优化技巧:</li>
</ol>
<ul>
<li>使用shouldComponentUpdate或React.memo来跳过不必要的渲染。</li>
<li>使用不可变数据结构来简化比较过程。</li>
</ul>
<ol start="9">
<li>虚拟DOM的内部表示:</li>
</ol>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> fiber <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'div'</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="3">  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token string">'container'</span><span class="token punctuation">,</span> <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token spread operator">...</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="4">  <span class="token literal-property property">stateNode</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> <span class="token comment">// 指向真实DOM节点</span>
</span><span class="code-line line-number" line="5">  <span class="token keyword control-flow">return</span><span class="token operator">:</span> parentFiber<span class="token punctuation">,</span>
</span><span class="code-line line-number" line="6">  <span class="token literal-property property">child</span><span class="token operator">:</span> childFiber<span class="token punctuation">,</span>
</span><span class="code-line line-number" line="7">  <span class="token literal-property property">sibling</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="8">  <span class="token literal-property property">alternate</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> <span class="token comment">// 指向旧的fiber，用于diff</span>
</span><span class="code-line line-number" line="9">  <span class="token literal-property property">effectTag</span><span class="token operator">:</span> <span class="token string">'UPDATE'</span><span class="token punctuation">,</span> <span class="token comment">// 标记需要执行的DOM操作</span>
</span><span class="code-line line-number" line="10">  <span class="token comment">// ... 其他属性</span>
</span><span class="code-line line-number" line="11"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre>
<ol start="10">
<li>渲染到真实DOM:</li>
</ol>
<p>React最终会调用原生DOM API（如 document.createElement）来创建或更新真实DOM。</p>
<p>对于Web环境，这通过ReactDOM.render()或ReactDOM.createRoot().render()完成。</p>
<h2 id="16-虚拟dom的工作原理及其相关细节">16. 虚拟DOM的工作原理及其相关细节:</h2><a href="#16-虚拟dom的工作原理及其相关细节"><span class="icon icon-link"></span></a>
<ol>
<li>虚拟DOM的本质
虚拟DOM本质上是一个轻量级的JavaScript对象,它是对真实DOM的一种抽象表示。每个虚拟DOM对象通常包含以下信息:</li>
</ol>
<ul>
<li>标签名(tag name)</li>
<li>属性(properties)</li>
<li>子节点(children)
例如,一个简单的虚拟DOM对象可能看起来像这样:</li>
</ul>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'div'</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="3">  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">    <span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token string">'container'</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="5">    <span class="token function-variable function">onClick</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="6">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="7">  <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-line line-number" line="8">    <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="9">      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'p'</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="10">      <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token string">'text'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="11">      <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Hello, World!'</span><span class="token punctuation">]</span>
</span><span class="code-line line-number" line="12">    <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="13">  <span class="token punctuation">]</span>
</span><span class="code-line line-number" line="14"><span class="token punctuation">}</span>
</span></code></pre>
<ol start="2">
<li>虚拟DOM的创建过程
当应用状态发生变化时,框架(如React)会重新调用渲染函数。这个函数返回新的虚拟DOM树。这个过程是快速且高效的,因为它只涉及JavaScript对象的创建和操作。</li>
<li>Diff算法详解
Diff算法是虚拟DOM技术的核心,它负责比较两棵虚拟DOM树,找出需要更新的部分。这个算法通常遵循以下原则:
a) 同层比较: 只比较同一层级的节点,不会跨层级比较。
b) 类型比较: 如果节点类型改变,会直接替换整个子树。
c) Key属性: 使用key属性来标识列表中的元素,以优化对列表的diff操作。</li>
</ol>
<p>Diff算法的基本步骤如下:</p>
<ul>
<li>比较根节点: 如果类型不同,直接替换整个树。</li>
<li>比较属性: 如果类型相同,更新变化的属性。</li>
<li>比较子节点: 递归地对子节点进行diff。</li>
</ul>
<ol start="4">
<li>批量更新
在完成diff操作后,框架会生成一系列最小化的DOM操作指令。这些指令会被批量执行,以减少浏览器重排(reflow)和重绘(repaint)的次数。</li>
<li>调和过程(Reconciliation)
在React中,整个更新过程被称为”调和”(Reconciliation)。这个过程不仅包括diff和更新,还包括组件生命周期的管理等。</li>
<li>虚拟DOM vs 直接操作DOM
虚拟DOM相比直接操作DOM有以下优势:</li>
</ol>
<ul>
<li>减少DOM操作: 通过批量更新减少了实际DOM操作的次数。</li>
<li>跨平台: 虚拟DOM是平台无关的,可以用于服务器端渲染或原生移动应用。</li>
<li>声明式编程: 开发者只需关注状态的变化,而不是具体的DOM操作。</li>
</ul>
<ol start="7">
<li>性能优化技巧
为了进一步提高虚拟DOM的性能,可以采用以下策略:</li>
</ol>
<ul>
<li>使用PureComponent或React.memo来避免不必要的渲染。</li>
<li>正确使用key属性,特别是在渲染列表时。</li>
<li>使用不可变(immutable)数据结构来简化比较过程。</li>
</ul>
<h2 id="17-react-fiber">17. React Fiber</h2><a href="#17-react-fiber"><span class="icon icon-link"></span></a>
<ol>
<li>Fiber的本质
Fiber本质上是一个代表工作单元的JavaScript对象。每个React元素都对应一个Fiber节点。一个Fiber节点大致看起来是这样的:</li>
</ol>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'div'</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="3">  <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="4">  <span class="token literal-property property">stateNode</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="5">  <span class="token literal-property property">child</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="6">  <span class="token literal-property property">sibling</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="7">  <span class="token keyword control-flow">return</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="8">  <span class="token literal-property property">pendingProps</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="9">  <span class="token literal-property property">memoizedProps</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="10">  <span class="token literal-property property">memoizedState</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="11">  <span class="token literal-property property">updateQueue</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="12">  <span class="token literal-property property">effectTag</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="13">  <span class="token literal-property property">nextEffect</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="14">  <span class="token literal-property property">firstEffect</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="15">  <span class="token literal-property property">lastEffect</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="16">  <span class="token literal-property property">expirationTime</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="17">  <span class="token literal-property property">alternate</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="18"><span class="token punctuation">}</span>
</span></code></pre>
<ol start="2">
<li>Fiber的主要目标
Fiber架构的主要目标是实现增量渲染,即能够将渲染工作分割成小的任务块并将其分散到多个帧中。</li>
<li>Fiber树和工作原理
React维护两棵Fiber树:当前树和工作进行中树。当前树代表当前屏幕上显示的状态,而工作进行中树是我们构建的新树。</li>
</ol>
<p>工作过程大致如下:
a) 开始渲染时,React创建一个根Fiber节点。
b) 进入”render phase”,遍历Fiber树,为每个节点执行工作。
c) 完成”render phase”后,得到一个效果列表(Effect List)。
d) 进入”commit phase”,根据效果列表更新DOM。</p>
<ol start="4">
<li>调度和优先级
Fiber引入了任务优先级的概念。不同的更新可能有不同的优先级:</li>
</ol>
<ul>
<li>Synchronous: 必须同步完成的任务</li>
<li>Task:在当前事件循环结束之前完成</li>
<li>Animation: 在下一帧之前完成</li>
<li>High: 稍后完成,但保证在接下来的几帧内完成</li>
<li>Low: 可以推迟,但最终必须完成</li>
<li>Offscreen: 可以无限期推迟,直到有足够的空闲时间</li>
</ul>
<ol start="5">
<li>时间分片
Fiber利用requestIdleCallback API(在React中使用自己的polyfill实现)来进行时间分片。这允许React在浏览器空闲时执行工作,从而不阻塞主线程。</li>
</ol>
<h2 id="18-react-中的-lifting-state-up-是什么">18. React 中的 Lifting State Up 是什么？</h2><a href="#18-react-中的-lifting-state-up-是什么"><span class="icon icon-link"></span></a>
<p>当多个组件需要共享相同的变化数据时，建议将共享状态提升到它们最近的共同祖先。这意味着，如果两个子组件共享来自其父级的相同数据，则将状态移动到父级，而不是在两个子组件中维护本地状态。</p>
<h2 id="19-children-属性是什么">19. children 属性是什么？</h2><a href="#19-children-属性是什么"><span class="icon icon-link"></span></a>
<p><code>children</code>是一个 prop，它允许您将组件作为数据传递给其他组件，就像您使用的任何其他 prop 一样。放置在组件的开始和结束标记之间的组件树将作为prop传递给该组件。</p>
<p>children prop 的简单用法如下，</p>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyDiv</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="3">      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="4"><span class="token plain-text">        </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="5"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="8">
</span><span class="code-line line-number" line="9"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Greeting</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="10">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="11">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">MyDiv</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="12"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token string">"Hello"</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="13"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token string">"World"</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="14"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span><span class="token class-name">MyDiv</span></span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="15">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="16"><span class="token punctuation">}</span>
</span></code></pre>
<h2 id="20-react中的reconciliation是什么">20. React中的Reconciliation是什么？</h2><a href="#20-react中的reconciliation是什么"><span class="icon icon-link"></span></a>
<p>React中的Reconciliation是React的核心概念之一，它负责将React应用程序的状态和UI树映射到真实的DOM节点上。React的Reconciliation算法是一个递归的算法，它比较新旧树的节点，并根据差异更新DOM节点。</p>
<ol>
<li>定义：Reconciliation是React用来比较新旧虚拟DOM树，确定需要进行哪些实际DOM更新的过程</li>
<li>目的: 提高性能，最小化对实际DOM的操作</li>
<li>工作原理:</li>
</ol>
<ul>
<li>当组件的状态或属性改变时，React会创建一个新的虚拟DOM树</li>
<li>React然后将这个新树与旧的虚拟DOM树进行比较</li>
<li>通过这个比较过程，React确定哪些部分需要更新</li>
</ul>
<ol start="4">
<li>主要策略:</li>
</ol>
<ul>
<li>不同类型的元素会产生不同的树</li>
<li>开发者可以通过key属性来暗示哪些子元素在不同渲染中是稳定的</li>
</ul>
<ol start="5">
<li>Diffing算法: React使用启发式算法来高效地比较树，时间复杂度从O(n^3)优化到O(n)</li>
</ol>
<h3 id="具体比较策略">具体比较策略</h3><a href="#具体比较策略"><span class="icon icon-link"></span></a>
<ol>
<li>元素类型比较:</li>
</ol>
<ul>
<li>如果根元素类型不同，React 会拆除旧树，构建新树。</li>
<li>例如，从 <code>&#x3C;div></code> 到 <code>&#x3C;span></code>，<code>&#x3C;Button></code> 到 <code>&#x3C;div></code> 等</li>
</ul>
<ol start="2">
<li>DOM 元素比较:</li>
</ol>
<ul>
<li>对于相同类型的 DOM 元素，React 只更新改变的属性</li>
</ul>
<ol start="3">
<li>组件元素比较:</li>
</ol>
<ul>
<li>对于相同类型的组件元素，React 更新组件实例的 props，并调用 componentDidUpdate 生命周期方法</li>
</ul>
<ol start="4">
<li>子元素递归:</li>
</ol>
<ul>
<li>默认情况下，React 会递归 DOM 节点的子元素</li>
</ul>
<ol start="5">
<li>Keys的使用:</li>
</ol>
<ul>
<li>当子元素拥有 key 时，React 使用 key 来匹配原有树上的子元素和新树上的子元素</li>
</ul>
<h3 id="优化-reconciliation-过程-react-17">优化 Reconciliation 过程 (React 17+):</h3><a href="#优化-reconciliation-过程-react-17"><span class="icon icon-link"></span></a>
<ol>
<li>使用 React.memo 代替 PureComponent:</li>
</ol>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> <span class="token maybe-class-name">MyComponent</span> <span class="token operator">=</span> <span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token method function property-access">memo</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyComponent</span></span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token comment">// 组件逻辑</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ol start="2">
<li>使用 useMemo 和 useCallback:</li>
</ol>
<ul>
<li>useMemo 用于缓存计算结果</li>
<li>useCallback 用于缓存函数</li>
</ul>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> memoizedValue <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">computeExpensiveValue</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2"><span class="token keyword">const</span> memoizedCallback <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">doSomething</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ol start="3">
<li>使用 useReducer 处理复杂状态逻辑:</li>
</ol>
<ul>
<li>可以帮助将状态更新逻辑从组件中分离出来</li>
</ul>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialState<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ol start="4">
<li>合理使用 Context:</li>
</ol>
<ul>
<li>使用 Context 可以避免不必要的 prop drilling，但过度使用可能导致性能问题</li>
<li>考虑将 context 值的计算逻辑移到 provider 组件中</li>
</ul>
<ol start="5">
<li>使用 useRef 保存不需要触发重新渲染的值:</li>
</ol>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> prevProps <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ol start="6">
<li>慎用 useEffect:</li>
</ol>
<ul>
<li>正确设置依赖数组，避免不必要的效果执行</li>
<li>考虑使用 useLayoutEffect 处理需要同步执行的副作用</li>
</ul>
<ol start="7">
<li>使用 React.lazy 和 Suspense 进行代码分割:</li>
</ol>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> <span class="token maybe-class-name">OtherComponent</span> <span class="token operator">=</span> <span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token method function property-access">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">"./OtherComponent"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ol start="8">
<li>列表渲染优化:</li>
</ol>
<ul>
<li>正确使用 key 属性</li>
<li>考虑使用虚拟化库如 react-window 或 react-virtualized</li>
</ul>
<ol start="9">
<li>使用 Profiler API 进行性能分析:</li>
</ol>
<ul>
<li>帮助识别性能瓶颈</li>
</ul>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Profiler</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>MyComponent<span class="token punctuation">"</span></span> <span class="token attr-name">onRender</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>callback<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="2"><span class="token plain-text">  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">MyComponent</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="3"><span class="token plain-text"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span><span class="token class-name">Profiler</span></span><span class="token punctuation">></span></span>
</span></code></pre>
<ol start="10">
<li>使用新的 JSX 转换:</li>
</ol>
<ul>
<li>React 17 引入了新的 JSX 转换，不再需要显式导入 React</li>
</ul>
<ol start="11">
<li>使用 useTransition 和 useDeferredValue (React 18+):</li>
</ol>
<ul>
<li>用于处理非紧急更新，提高用户体验</li>
</ul>
<h4 id="1-usetransition">1. useTransition</h4><a href="#1-usetransition"><span class="icon icon-link"></span></a>
<p>useTransition 允许您将某些更新标记为非紧急，从而提高应用的响应性。</p>
<ul>
<li>场景：在一个搜索应用中，我们想在用户输入时立即更新搜索框，但延迟更新搜索结果，以避免在每次按键时都进行昂贵的搜索操作</li>
</ul>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useTransition <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword">const</span> <span class="token function-variable function">searchAPI</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">query</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token comment">// 模拟 API 调用</span>
</span><span class="code-line line-number" line="5">  <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="6">    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="7">      <span class="token function">resolve</span><span class="token punctuation">(</span>
</span><span class="code-line line-number" line="8">        <span class="token known-class-name class-name">Array</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="9">          <span class="token punctuation">.</span><span class="token method function property-access">fill</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="10">          <span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="11">      <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="12">    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="13">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="14"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="15">
</span><span class="code-line line-number" line="16"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">SearchApp</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="17">  <span class="token keyword">const</span> <span class="token punctuation">[</span>query<span class="token punctuation">,</span> setQuery<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="18">  <span class="token keyword">const</span> <span class="token punctuation">[</span>results<span class="token punctuation">,</span> setResults<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="19">  <span class="token keyword">const</span> <span class="token punctuation">[</span>isPending<span class="token punctuation">,</span> startTransition<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useTransition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="20">
</span><span class="code-line line-number" line="21">  <span class="token keyword">const</span> <span class="token function-variable function">handleSearch</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="22">    <span class="token keyword">const</span> newQuery <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="23">    <span class="token function">setQuery</span><span class="token punctuation">(</span>newQuery<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="24">
</span><span class="code-line line-number" line="25">    <span class="token function">startTransition</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="26">      <span class="token keyword">const</span> searchResults <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">searchAPI</span><span class="token punctuation">(</span>newQuery<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="27">      <span class="token function">setResults</span><span class="token punctuation">(</span>searchResults<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="28">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="29">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="30">
</span><span class="code-line line-number" line="31">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="32">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="33"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span>
</span></span><span class="code-line line-number" line="34"><span class="token tag">        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span>
</span></span><span class="code-line line-number" line="35"><span class="token tag">        <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>query<span class="token punctuation">}</span></span>
</span></span><span class="code-line line-number" line="36"><span class="token tag">        <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSearch<span class="token punctuation">}</span></span>
</span></span><span class="code-line line-number" line="37"><span class="token tag">        <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Search...<span class="token punctuation">"</span></span>
</span></span><span class="code-line line-number" line="38"><span class="token tag">      <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="39"><span class="token plain-text">      </span><span class="token punctuation">{</span>isPending <span class="token operator">&#x26;&#x26;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">Updating results...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="40"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="41"><span class="token plain-text">        </span><span class="token punctuation">{</span>results<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="42">          <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="43">        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="44"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="45"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="46">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="47"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="48">
</span><span class="code-line line-number" line="49"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token maybe-class-name">SearchApp</span><span class="token punctuation">;</span>
</span></code></pre>
<p>在这个例子中，点击按钮的更新被标记为非紧急。如果有其他更紧急的更新（如用户输入），React 会优先处理那些更新。</p>
<h4 id="2-usedeferredvalue">2. useDeferredValue</h4><a href="#2-usedeferredvalue"><span class="icon icon-link"></span></a>
<ul>
<li>场景：在一个数据可视化应用中，我们想要立即响应用户的输入，但延迟更新计算密集型的图表。</li>
</ul>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useDeferredValue<span class="token punctuation">,</span> useMemo <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token comment">// 假设这是一个计算密集型的组件</span>
</span><span class="code-line line-number" line="4"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ExpensiveChart</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="5">  <span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="6">    <span class="token comment">// 模拟耗时计算</span>
</span><span class="code-line line-number" line="7">    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Calculating chart data..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8">    <span class="token keyword control-flow">return</span> data<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="9">  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>data<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="10">
</span><span class="code-line line-number" line="11">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="12">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="13"><span class="token plain-text">      </span><span class="token punctuation">{</span>items<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="14">        <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="15">      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="16"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ul</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="17">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="18"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="19">
</span><span class="code-line line-number" line="20"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">DataVisualization</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="21">  <span class="token keyword">const</span> <span class="token punctuation">[</span>data<span class="token punctuation">,</span> setData<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="22">  <span class="token keyword">const</span> deferredData <span class="token operator">=</span> <span class="token function">useDeferredValue</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="23">
</span><span class="code-line line-number" line="24">  <span class="token keyword">const</span> <span class="token function-variable function">handleDataChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="25">    <span class="token keyword">const</span> newData <span class="token operator">=</span> <span class="token known-class-name class-name">Array</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="26">      <span class="token punctuation">.</span><span class="token method function property-access">fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="27">      <span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">floor</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="28">    <span class="token function">setData</span><span class="token punctuation">(</span>newData<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="29">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="30">
</span><span class="code-line line-number" line="31">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="32">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="33"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span>
</span></span><span class="code-line line-number" line="34"><span class="token tag">        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span>
</span></span><span class="code-line line-number" line="35"><span class="token tag">        <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleDataChange<span class="token punctuation">}</span></span>
</span></span><span class="code-line line-number" line="36"><span class="token tag">        <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Enter a number<span class="token punctuation">"</span></span>
</span></span><span class="code-line line-number" line="37"><span class="token tag">      <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="38"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">ExpensiveChart</span></span> <span class="token attr-name">data</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>deferredData<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="39"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="40">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="41"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="42">
</span><span class="code-line line-number" line="43"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token maybe-class-name">DataVisualization</span><span class="token punctuation">;</span>
</span></code></pre>
<h4 id="3-useid">3. useId</h4><a href="#3-useid"><span class="icon icon-link"></span></a>
<ul>
<li>场景：在一个表单中，我们需要为多个输入字段生成唯一的 ID，以确保正确的标签关联和可访问性。</li>
</ul>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> useId <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">AccessibleForm</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">useId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="7">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>form</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="8"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="9"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>label</span> <span class="token attr-name">htmlFor</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-name</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Name:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>label</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="10"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-name</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="11"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="12"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="13"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>label</span> <span class="token attr-name">htmlFor</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-email</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Email:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>label</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="14"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-email</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="15"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="16"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="17"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>label</span> <span class="token attr-name">htmlFor</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-password</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Password:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>label</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="18"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-password</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="19"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="20"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>form</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="21">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="22"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="23">
</span><span class="code-line line-number" line="24"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token maybe-class-name">AccessibleForm</span><span class="token punctuation">;</span>
</span></code></pre>
<h4 id="4-suspense-和-lazy">4. Suspense 和 lazy</h4><a href="#4-suspense-和-lazy"><span class="icon icon-link"></span></a>
<ul>
<li>场景：在一个单页应用中，我们想要延迟加载某些组件以提高初始加载速度。</li>
</ul>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">Suspense</span><span class="token punctuation">,</span> lazy <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">BrowserRouter</span> <span class="token keyword module">as</span> <span class="token maybe-class-name">Router</span><span class="token punctuation">,</span> <span class="token maybe-class-name">Route</span><span class="token punctuation">,</span> <span class="token maybe-class-name">Link</span><span class="token punctuation">,</span> <span class="token maybe-class-name">Routes</span> <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-router-dom'</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"><span class="token keyword">const</span> <span class="token maybe-class-name">Home</span> <span class="token operator">=</span> <span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">'./Home'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5"><span class="token keyword">const</span> <span class="token maybe-class-name">About</span> <span class="token operator">=</span> <span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">'./About'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6"><span class="token keyword">const</span> <span class="token maybe-class-name">Contact</span> <span class="token operator">=</span> <span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">'./Contact'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="9">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="10">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Router</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="11"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="12"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>nav</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="13"><span class="token plain-text">          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="14"><span class="token plain-text">            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Link</span></span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">Home</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span><span class="token class-name">Link</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="15"><span class="token plain-text">            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Link</span></span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/about<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">About</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span><span class="token class-name">Link</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="16"><span class="token plain-text">            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Link</span></span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/contact<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">Contact</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span><span class="token class-name">Link</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="17"><span class="token plain-text">          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="18"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>nav</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="19"><span class="token plain-text">
</span></span><span class="code-line line-number" line="20"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Suspense</span></span> <span class="token attr-name">fallback</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">Loading...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="21"><span class="token plain-text">          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Routes</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="22"><span class="token plain-text">            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Route</span></span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span> <span class="token attr-name">element</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Home</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="23"><span class="token plain-text">            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Route</span></span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/about<span class="token punctuation">"</span></span> <span class="token attr-name">element</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">About</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="24"><span class="token plain-text">            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Route</span></span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/contact<span class="token punctuation">"</span></span> <span class="token attr-name">element</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Contact</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="25"><span class="token plain-text">          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span><span class="token class-name">Routes</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="26"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span><span class="token class-name">Suspense</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="27"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="28"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span><span class="token class-name">Router</span></span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="29">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="30"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="31">
</span><span class="code-line line-number" line="32"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token maybe-class-name">App</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="33">
</span><span class="code-line line-number" line="34"><span class="token comment">// Home.js</span>
</span><span class="code-line line-number" line="35"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Home</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="36">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">Home</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="37"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="38">
</span><span class="code-line line-number" line="39"><span class="token comment">// About.js</span>
</span><span class="code-line line-number" line="40"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">About</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="41">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">About</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="42"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="43">
</span><span class="code-line line-number" line="44"><span class="token comment">// Contact.js</span>
</span><span class="code-line line-number" line="45"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Contact</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="46">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">Contact</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="47"><span class="token punctuation">}</span>
</span></code></pre>
<p>其他：</p>
<ul>
<li>自动批处理：React 18 引入了自动批处理，可以将多个状态更新组合成一次重渲染，提高性能。这在大多数情况下是自动的，不需要额外的代码。</li>
<li>Concurrent Rendering：虽然这不是一个具体的 API，但它是 React 18 的一个重要特性。它允许 React 中断渲染以处理更高优先级的更新，从而提高应用的响应性。useTransition 和 useDeferredValue 就是基于这个特性的。</li>
</ul>
<h2 id="21-react-中的合成事件是什么">21. React 中的合成事件是什么?</h2><a href="#21-react-中的合成事件是什么"><span class="icon icon-link"></span></a>
<p>React中的合成事件(Synthetic Events)是React对原生DOM事件的封装。它的 API 与浏览器的原生事件相同，包括<code>stopPropagation()</code>和<code>preventDefault()</code></p>
<ul>
<li>主要特点和用途</li>
</ul>
<ol>
<li>跨浏览器标准化: React确保所有事件在不同浏览器中的行为一致 。</li>
<li>性能优化: React使用事件委托,将所有事件都绑定到文档根节点,而不是每个单独的元素。</li>
<li>自动绑定: 在类组件中,事件处理器会自动绑定到组件实例。</li>
<li>事件池: React重用事件对象以提高性能,所以事件对象属性在事件回调结束后会被清空。</li>
<li>支持异步访问: 如果需要异步访问事件属性,可以使用event.persist()方法。</li>
<li>命名约定: 使用驼峰命名法,如onClick而不是onclick。</li>
<li>传递函数: 传递函数作为事件处理器,而不是字符串。</li>
</ol>
<ul>
<li>工作原理</li>
</ul>
<ol>
<li>事件委托: React并不直接将事件处理器附加到DOM节点。相反,它在文档的根级别使用单个事件监听器来处理所有事件</li>
<li>事件池: 为了提高性能,React维护一个事件对象池。当事件触发时,React从池中获取一个事件对象,填充相关信息,然后将其传递给事件处理器。事件处理完成后,对象会被重置并返回池中</li>
<li>事件规范化: React确保事件对象在不同浏览器中具有一致的属性</li>
<li>异步处理: 由于事件池的存在,如果你需要在异步操作中访问事件对象,需要调用<code>event.persist()</code></li>
</ol>
<h4 id="处理表单输入">处理表单输入</h4><a href="#处理表单输入"><span class="icon icon-link"></span></a>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">NameForm</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token method function property-access">useState</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4">  <span class="token keyword">const</span> <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="5">    <span class="token function">setName</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8">  <span class="token keyword">const</span> <span class="token function-variable function">handleSubmit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="9">    event<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 阻止表单默认提交行为</span>
</span><span class="code-line line-number" line="10">    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"A name was submitted: "</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="11">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="12">
</span><span class="code-line line-number" line="13">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="14">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>form</span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="15"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>label</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="16"><span class="token plain-text">        Name:
</span></span><span class="code-line line-number" line="17"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="18"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>label</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="19"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Submit<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="20"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>form</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="21">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="22"><span class="token punctuation">}</span>
</span></code></pre>
<h4 id="使用eventpersist进行异步处理">使用event.persist()进行异步处理</h4><a href="#使用eventpersist进行异步处理"><span class="icon icon-link"></span></a>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">DelayedLogger</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">    event<span class="token punctuation">.</span><span class="token method function property-access">persist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 允许在异步回调中访问事件属性</span>
</span><span class="code-line line-number" line="4">    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="5">      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">type</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'click'</span>
</span><span class="code-line line-number" line="6">    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8">
</span><span class="code-line line-number" line="9">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Click me</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="10"><span class="token punctuation">}</span>
</span></code></pre>
<h4 id="处理键盘事件">处理键盘事件</h4><a href="#处理键盘事件"><span class="icon icon-link"></span></a>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">KeyDetector</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">const</span> <span class="token function-variable function">handleKeyPress</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">key</span> <span class="token operator">===</span> <span class="token string">"Enter"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Enter key pressed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">    <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="6">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">onKeyPress</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleKeyPress<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="9"><span class="token punctuation">}</span>
</span></code></pre>
<h4 id="阻止事件冒泡">阻止事件冒泡</h4><a href="#阻止事件冒泡"><span class="icon icon-link"></span></a>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">StopPropagation</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">const</span> <span class="token function-variable function">handleParentClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Parent clicked"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6">  <span class="token keyword">const</span> <span class="token function-variable function">handleChildClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="7">    event<span class="token punctuation">.</span><span class="token method function property-access">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 阻止事件冒泡到父元素</span>
</span><span class="code-line line-number" line="8">    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Child clicked"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="9">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="10">
</span><span class="code-line line-number" line="11">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="12">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span>
</span></span><span class="code-line line-number" line="13"><span class="token tag">      <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleParentClick<span class="token punctuation">}</span></span>
</span></span><span class="code-line line-number" line="14"><span class="token tag">      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token string">"20px"</span><span class="token punctuation">,</span> <span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">"lightblue"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line line-number" line="15"><span class="token tag">    <span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="16"><span class="token plain-text">      Parent
</span></span><span class="code-line line-number" line="17"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleChildClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Child</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="18"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="19">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="20"><span class="token punctuation">}</span>
</span></code></pre>
<h4 id="访问原生事件">访问原生事件</h4><a href="#访问原生事件"><span class="icon icon-link"></span></a>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">NativeEventAccess</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"React synthetic event:"</span><span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4">    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Native DOM event:"</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span><span class="token property-access">nativeEvent</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Click for native event</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8"><span class="token punctuation">}</span>
</span></code></pre>
<h2 id="22-什么是-reactdomserver">22. 什么是 ReactDOMServer</h2><a href="#22-什么是-reactdomserver"><span class="icon icon-link"></span></a>
<p>ReactDOMServer 是 React 库的一部分，它提供了将 React 组件渲染成静态 HTML 字符串的方法。这在服务器端渲染（SSR）中特别有用，可以提高首屏加载速度和搜索引擎优化（SEO）
以下是 ReactDOMServer 的主要特点和用法：</p>
<ul>
<li>主要方法:</li>
</ul>
<ol>
<li><code>renderToString()</code>: 将 React 元素渲染为初始 HTML</li>
<li><code>renderToStaticMarkup()</code>: 类似于 renderToString，但不会创建额外的 DOM 属性，如 data-reactroot</li>
<li><code>renderToNodeStream()</code>: 返回一个可读流，输出 HTML 字符串。（仅在服务器环境中可用）</li>
<li><code>renderToStaticNodeStream()</code>: 类似于 renderToNodeStream，但不包含额外的 DOM 属性。（仅在服务器环境中可用）</li>
</ol>
<ul>
<li>用途:</li>
</ul>
<ol>
<li>服务器端渲染（SSR）</li>
<li>生成静态网站</li>
<li>在非浏览器环境中渲染 React 组件</li>
</ol>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ReactDOMServer</span></span> <span class="token keyword module">from</span> <span class="token string">"react-dom/server"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">"./App"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"><span class="token keyword">function</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="5">  <span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token maybe-class-name">ReactDOMServer</span><span class="token punctuation">.</span><span class="token method function property-access">renderToString</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">App</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7">  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
</span></span></span><span class="code-line line-number" line="8"><span class="token template-string"><span class="token string">    &#x3C;!DOCTYPE html>
</span></span></span><span class="code-line line-number" line="9"><span class="token template-string"><span class="token string">    &#x3C;html>
</span></span></span><span class="code-line line-number" line="10"><span class="token template-string"><span class="token string">      &#x3C;head>
</span></span></span><span class="code-line line-number" line="11"><span class="token template-string"><span class="token string">        &#x3C;title>My React App&#x3C;/title>
</span></span></span><span class="code-line line-number" line="12"><span class="token template-string"><span class="token string">      &#x3C;/head>
</span></span></span><span class="code-line line-number" line="13"><span class="token template-string"><span class="token string">      &#x3C;body>
</span></span></span><span class="code-line line-number" line="14"><span class="token template-string"><span class="token string">        &#x3C;div id="root"></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>html<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&#x3C;/div>
</span></span></span><span class="code-line line-number" line="15"><span class="token template-string"><span class="token string">        &#x3C;script src="/bundle.js">&#x3C;/script>
</span></span></span><span class="code-line line-number" line="16"><span class="token template-string"><span class="token string">      &#x3C;/body>
</span></span></span><span class="code-line line-number" line="17"><span class="token template-string"><span class="token string">    &#x3C;/html>
</span></span></span><span class="code-line line-number" line="18"><span class="token template-string"><span class="token string">  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="19"><span class="token punctuation">}</span>
</span></code></pre>
<ul>
<li>优势:</li>
</ul>
<ol>
<li>改善首屏加载时间</li>
<li>提高搜索引擎优化（SEO）表现</li>
<li>支持在不支持 JavaScript 的环境中使用 React</li>
</ol>
<ul>
<li>注意事项:</li>
</ul>
<ol>
<li>服务器端渲染的组件应该是”同构”的，即可以在服务器和客户端都能运行</li>
<li>某些生命周期方法（如 componentDidMount）在服务器端不会被调用</li>
<li>需要注意服务器端和客户端状态的同步</li>
</ol>
<ul>
<li>与<code>hydration</code>配合:
在客户端，通常会使用 ReactDOM.hydrate() 方法来”激活”服务器渲染的 HTML：</li>
</ul>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ReactDOM</span></span> <span class="token keyword module">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">"./App"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"><span class="token maybe-class-name">ReactDOM</span><span class="token punctuation">.</span><span class="token method function property-access">hydrate</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">App</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">,</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>性能考虑:
虽然服务器端渲染可以提高初始加载性能，但它也会增加服务器负载。在实际应用中，通常会结合缓存策略来优化性能。
总的来说，ReactDOMServer 是实现 React 服务器端渲染的核心工具，它允许开发者在服务器上生成 HTML 内容，从而提供更好的首屏体验和 SEO 优化。然而，使用服务器端渲染也会增加应用的复杂性，因此需要权衡其利弊，并根据具体项目需求来决定是否采用</li>
</ul>
<h2 id="23-有哪些流行的react特定的linters">23. 有哪些流行的react特定的linters</h2><a href="#23-有哪些流行的react特定的linters"><span class="icon icon-link"></span></a>
<p><code>eslint-plugin-react</code>:</p>
<ul>
<li>是一个专门为 React 项目设计的 ESLint 插件。它的主要功能包括</li>
</ul>
<ol>
<li>提供 React 特定的代码规则:</li>
</ol>
<ul>
<li>检查 JSX 语法,验证 React 组件的结构和用法,检查 Hooks 的使用是否正确</li>
</ul>
<ol start="2">
<li>帮助开发者遵循 React 最佳实践</li>
</ol>
<ul>
<li>强制使用正确的组件命名规范,检查 props 的使用和验证,识别潜在的性能问题</li>
</ul>
<ol start="3">
<li>提高代码质量</li>
</ol>
<ul>
<li>检测常见的 React 相关错误,强制执行一致的编码风格</li>
</ul>
<ol start="4">
<li>自定义规则</li>
</ol>
<ul>
<li>允许团队根据项目需求配置和自定义规则</li>
</ul>
<ol start="5">
<li>与 ESLint 生态系统集成</li>
</ol>
<h2 id="24-什么是-react-router">24. 什么是 React Router？</h2><a href="#24-什么是-react-router"><span class="icon icon-link"></span></a>
<p>React Router 是一个基于 React 构建的强大的路由库，可帮助你添加新的屏幕并以极快的速度流向您的应用程序，同时保持 URL 与页面上显示的内容同步。
允许您在单页应用（SPA）中实现动态路由，从而使用户可以在不同页面之间导航，而无需刷新整个页面。以下是 React Router 的一些主要特点：</p>
<ol>
<li>声明式路由：使用 JSX 语法定义路由。</li>
<li>嵌套路由：支持创建复杂的路由结构。</li>
<li>动态路由匹配：可以使用参数来创建动态路由。</li>
<li>编程式导航：允许通过 JavaScript 代码控制导航。</li>
<li>历史管理：提供了对浏览器历史记录的访问和操作。</li>
<li>支持不同的路由模式：如哈希模式和浏览器历史模式。</li>
</ol>
<h2 id="25-react-router与history库有何不同">25. React Router与History库有何不同？</h2><a href="#25-react-router与history库有何不同"><span class="icon icon-link"></span></a>
<p>React Router是历史库的包装器，它处理浏览器的<code>window.history</code>及其浏览器和缓存历史记录的交互。它还提供内存历史记录，对于没有全局记录历史的环境很有用，例如移动应用程序开发（React Native）并使用 Node 进行单元测试。
总之就是History.js是Window.history API的一个包装，处理了很多浏览器的兼容等问题。而React Router又是History.js的一个包装，提供了声明式路由的能力。并更贴合React的开发模式。</p>
<h2 id="26-react为什么使用classname属性而不是class属性作为类名">26. React为什么使用className属性而不是class属性作为类名？</h2><a href="#26-react为什么使用classname属性而不是class属性作为类名"><span class="icon icon-link"></span></a>
<ol>
<li>避免与javascript关键字冲突，在javascript中class是一个保留关键字，用于定义类。</li>
<li>因为原生html定义类名使用的是class，而React中的jsx是javascript的语法扩展,避免和html类名操作冲突。有助于区分jsx特有的属性和标准html属性。</li>
</ol>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token comment">// JSX</span>
</span><span class="code-line line-number" line="2"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>my-class<span class="token punctuation">"</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="3"><span class="token plain-text">  ...
</span></span><span class="code-line line-number" line="4"><span class="token plain-text"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6"><span class="token comment">// 编译后的JavaScript</span>
</span><span class="code-line line-number" line="7"><span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span>
</span><span class="code-line line-number" line="8">  <span class="token string">"div"</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="9">  <span class="token punctuation">{</span> <span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token string">"my-class"</span><span class="token punctuation">,</span> <span class="token literal-property property">onClick</span><span class="token operator">:</span> handleClick <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="10">  <span class="token string">"..."</span>
</span><span class="code-line line-number" line="11"><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ol start="3">
<li>性能考虑和未来兼容性及跨平台性，因为不需要处理class同名的情况，对于未来不同平台下也保持其特有性，而且保持这种一致性有助于代码的可读性和可维护性。</li>
</ol>
<h2 id="27-什么是react-createportal">27. 什么是React createPortal?</h2><a href="#27-什么是react-createportal"><span class="icon icon-link"></span></a>
<p><code>React createPortal</code> 是一个允许我们将子组件渲染到父组件 DOM 树之外的其他 DOM 节点的方法。</p>
<ul>
<li>应用场景:</li>
</ul>
<ol>
<li>模态框（Modal）: 通常我们希望模态框渲染在页面的最顶层，而不是嵌套在当前组件树中.</li>
<li>工具提示（Tooltip）: 可能需要渲染在触发元素之外的位置.</li>
<li>悬浮卡片（Floating Card）: 类似于工具提示，但通常包含更多信息</li>
<li>下拉菜单（Dropdown）: 特别是当父容器有 overflow: hidden 时</li>
<li>通知消息（Notifications）: 通常显示在页面顶部或角落</li>
</ol>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createPortal <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Modal</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children<span class="token punctuation">,</span> onClose <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="5">  <span class="token keyword control-flow">return</span> <span class="token function">createPortal</span><span class="token punctuation">(</span>
</span><span class="code-line line-number" line="6">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-overlay<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="7"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="8"><span class="token plain-text">        </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="9"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onClose<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">关闭</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="10"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="11"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="12">    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span>
</span><span class="code-line line-number" line="13">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="14"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="15">
</span><span class="code-line line-number" line="16"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="17">  <span class="token keyword">const</span> <span class="token punctuation">[</span>showModal<span class="token punctuation">,</span> setShowModal<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="18">
</span><span class="code-line line-number" line="19">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="20">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="21"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setShowModal</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">打开模态框</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="22"><span class="token plain-text">      </span><span class="token punctuation">{</span>showModal <span class="token operator">&#x26;&#x26;</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="23">        <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Modal</span></span> <span class="token attr-name">onClose</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setShowModal</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="24"><span class="token plain-text">          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">这是一个模态框</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="25"><span class="token plain-text">          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">模态框内容...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="26"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span><span class="token class-name">Modal</span></span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="27">      <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="28"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="29">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="30"><span class="token punctuation">}</span>
</span></code></pre>
<ul>
<li>适合使用 createPortal 的情况:</li>
</ul>
<ol>
<li>需要突破当前 DOM 结构限制的场景</li>
<li>处理 z-index 和堆叠上下文问题</li>
<li>需要在视觉上和逻辑上分离的 UI 元素</li>
</ol>
<ul>
<li>不适合使用 createPortal 的情况:</li>
</ul>
<ol>
<li>组件逻辑紧密耦合，需要共享上下文的场景</li>
<li>可能导致可访问性问题的情况，如屏幕阅读器可能难以理解 portal 内容</li>
<li>过度使用可能导致应用结构混乱，增加维护难度</li>
</ol>
<h2 id="28-如何在react中使用innerhtml">28. 如何在React中使用innerHTML?</h2><a href="#28-如何在react中使用innerhtml"><span class="icon icon-link"></span></a>
<p>在React中使用innerHTML需要谨慎,因为它可能会带来安全风险。不过,在某些情况下使用innerHTML是必要的。以下是在React中使用innerHTML的方法:</p>
<ol>
<li>使用dangerouslySetInnerHTML属性:</li>
</ol>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">const</span> htmlContent <span class="token operator">=</span> <span class="token string">"&#x3C;p>这是一些&#x3C;strong>HTML&#x3C;/strong>内容&#x3C;/p>"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">dangerouslySetInnerHTML</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">__html</span><span class="token operator">:</span> htmlContent <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5"><span class="token punctuation">}</span>
</span></code></pre>
<ol start="2">
<li>使用ReactDOM.renderToString:</li>
</ol>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ReactDOM</span></span> <span class="token keyword module">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="5">  <span class="token keyword">const</span> htmlContent <span class="token operator">=</span> <span class="token string">"&#x3C;p>这是一些&#x3C;strong>HTML&#x3C;/strong>内容&#x3C;/p>"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">dangerouslySetInnerHTML</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">__html</span><span class="token operator">:</span> htmlContent <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="9">
</span><span class="code-line line-number" line="10"><span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token maybe-class-name">ReactDOM</span><span class="token punctuation">.</span><span class="token method function property-access">renderToString</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">MyComponent</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ol start="3">
<li>使用ReactDOM.renderToStaticMarkup:</li>
</ol>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ReactDOM</span></span> <span class="token keyword module">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="5">  <span class="token keyword">const</span> htmlContent <span class="token operator">=</span> <span class="token string">"&#x3C;p>这是一些&#x3C;strong>HTML&#x3C;/strong>内容&#x3C;/p>"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">dangerouslySetInnerHTML</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">__html</span><span class="token operator">:</span> htmlContent <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="9">
</span><span class="code-line line-number" line="10"><span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token maybe-class-name">ReactDOM</span><span class="token punctuation">.</span><span class="token method function property-access">renderToStaticMarkup</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">MyComponent</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ol start="4">
<li>使用第三方库:</li>
</ol>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ReactDOM</span></span> <span class="token keyword module">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> renderHTML <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react-html-parser"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="6">  <span class="token keyword">const</span> htmlContent <span class="token operator">=</span> <span class="token string">"&#x3C;p>这是一些&#x3C;strong>HTML&#x3C;/strong>内容&#x3C;/p>"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token function">renderHTML</span><span class="token punctuation">(</span>htmlContent<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="9"><span class="token punctuation">}</span>
</span></code></pre>
<ol start="5">
<li>使用ref和原生DOM操作:</li>
</ol>
<pre class="language-jsx language-jsx"><code is:raw="" class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword">const</span> divRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6">  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="7">    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>divRef<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="8">      divRef<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">.</span><span class="token property-access">innerHTML</span> <span class="token operator">=</span> <span class="token string">"&#x3C;p>这是一些&#x3C;strong>HTML&#x3C;/strong>内容&#x3C;/p>"</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="9">    <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="10">  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="11">
</span><span class="code-line line-number" line="12">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>divRef<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="13"><span class="token punctuation">}</span>
</span></code></pre> </article>  </div> <div class="mt-5 flex justify-between gap-x-12 py-2"> <span class="flex-1"></span> <div class="flex flex-1 flex-col justify-items-end gap-1 truncate  py-1 text-right "> <span>Next</span> <a href="/posts/58b82c0a" class="truncate">   免费博客托管网站平台 </a> </div> </div> </main>  <div id="pwa-toast" class="fixed left-[50%] top-5 z-10 hidden -translate-x-[50%]" role="alert" aria-labelledby="toast-message"> <div class="bg-primary-light flex min-w-[300px] flex-wrap gap-5 rounded-xl border px-5 py-2 dark:border-primary-gray dark:bg-primary-dark"> <span id="toast-message">检测到页面内容有更新更新，是否刷新页面</span> <button id="pwa-refresh" class="hover:text-primary" aria-label="yes">是</button> <button id="pwa-close" class="hover:text-primary" aria-label="no">否</button> </div> </div>  <svg class="nav-icon dark:fill-primary-light fixed bottom-10 right-5 hidden rotate-180 cursor-pointer fill-primary-dark transition-all" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9313" width="45" height="45"> <path d="M535.12 442.432v210.016a16 16 0 0 1-16 16h-16.16a16 16 0 0 1-16-16V440.208l-32.88 32.864a16 16 0 0 1-11.312 4.688h-28.304a14.464 14.464 0 0 1-10.24-24.688l97.824-97.808a11.136 11.136 0 0 1 15.744 0l97.808 97.808a14.464 14.464 0 0 1-10.24 24.688h-28.288a16 16 0 0 1-11.312-4.688l-30.64-30.64zM512 800c159.056 0 288-128.944 288-288s-128.944-288-288-288-288 128.944-288 288 128.944 288 288 288z m0 48c-185.568 0-336-150.432-336-336s150.432-336 336-336 336 150.432 336 336-150.432 336-336 336z" p-id="9314"></path> </svg>  </body></html>